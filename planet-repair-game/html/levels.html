<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å…³å¡é€‰æ‹© - ä¿®ä¸€ä¸ªæ˜Ÿçƒ</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/levels-fixed.css">
</head>
<body>
    <div class="game-container">
        <!-- å…³å¡å®¹å™¨ -->
        <div class="levels-container">
            <!-- å…³å¡1 - åˆå§‹çŠ¶æ€ -->
            <div class="level-card" data-level="1">
                <div class="level-background">
                    <img src="../images/level-1-bg.png" alt="å…³å¡1" class="level-bg-image">
                </div>
                <div class="level-label">
                    <span class="level-text">å…³å¡ 1</span>
                </div>
            </div>
            
            <!-- å…³å¡2 - é”å®š -->
            <div class="level-card locked" data-level="2">
                <div class="level-background">
                    <img src="../images/level-2-bg.png" alt="å…³å¡2" class="level-bg-image">
                    <div class="level-overlay"></div>
                </div>
                <div class="level-label">
                    <span class="level-text">å…³å¡ 2</span>
                </div>
            </div>
            
            <!-- å…³å¡3 - é”å®š -->
            <div class="level-card locked" data-level="3">
                <div class="level-background">
                    <img src="../images/level-3-bg.png" alt="å…³å¡3" class="level-bg-image">
                    <div class="level-overlay"></div>
                </div>
                <div class="level-label">
                    <span class="level-text">å…³å¡ 3</span>
                </div>
            </div>
            
            <!-- å…³å¡4 - é”å®š -->
            <div class="level-card locked" data-level="4">
                <div class="level-background">
                    <img src="../images/level-4-bg.png" alt="å…³å¡4" class="level-bg-image">
                    <div class="level-overlay"></div>
                </div>
                <div class="level-label">
                    <span class="level-text">å…³å¡ 4</span>
                </div>
            </div>
            
            <!-- å…³å¡5 - é”å®š -->
            <div class="level-card locked" data-level="5">
                <div class="level-background">
                    <img src="../images/level-5-bg.png" alt="å…³å¡5" class="level-bg-image">
                    <div class="level-overlay"></div>
                </div>
                <div class="level-label">
                    <span class="level-text">å…³å¡ 5</span>
                </div>
            </div>
            
            <!-- å…³å¡6 - é”å®š -->
            <div class="level-card locked" data-level="6">
                <div class="level-background">
                    <img src="../images/level-6-bg.png" alt="å…³å¡6" class="level-bg-image">
                    <div class="level-overlay"></div>
                </div>
                <div class="level-label">
                    <span class="level-text">å…³å¡ 6</span>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../js/base.js"></script>
    <script src="../js/levels.js"></script>
    
    <!-- ç§»åŠ¨ç«¯è§¦æ‘¸ä¿®å¤ - å¤‡ç”¨äº‹ä»¶å¤„ç† -->
    <script>
        console.log('ğŸ”§ åŠ è½½ç§»åŠ¨ç«¯è§¦æ‘¸ä¿®å¤');
        
        // ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½åæ‰§è¡Œ
        setTimeout(() => {
            console.log('ğŸš€ å¼€å§‹ç§»åŠ¨ç«¯è§¦æ‘¸ä¿®å¤');
            
            const cards = document.querySelectorAll('.level-card');
            console.log(`ğŸ¯ æ‰¾åˆ° ${cards.length} ä¸ªå…³å¡å¡ç‰‡ï¼Œå¼€å§‹ä¿®å¤è§¦æ‘¸äº‹ä»¶`);
            
            cards.forEach((card, index) => {
                const levelNum = index + 1;
                
                console.log(`ğŸ”§ ä¿®å¤å…³å¡ ${levelNum} è§¦æ‘¸äº‹ä»¶`);
                
                // å¼ºåˆ¶å¯ç”¨è§¦æ‘¸
                card.style.touchAction = 'manipulation';
                card.style.userSelect = 'none';
                card.style.webkitTapHighlightColor = 'transparent';
                card.style.pointerEvents = 'auto';
                
                // å¤‡ç”¨ç‚¹å‡»å¤„ç†å‡½æ•°
                function backupLevelClick() {
                    console.log(`ğŸš€ å¤‡ç”¨ç‚¹å‡»å¤„ç† - å…³å¡ ${levelNum}`);
                    
                    // æ£€æŸ¥æ¸¸æˆè¿›åº¦
                    let gameProgress = {};
                    try {
                        const saved = localStorage.getItem('planetRepairGameProgress');
                        if (saved) {
                            gameProgress = JSON.parse(saved);
                        } else {
                            gameProgress = {
                                level1Completed: false,
                                currentLevel: 1,
                                unlockedLevels: [1]
                            };
                        }
                    } catch (error) {
                        console.error('è¯»å–è¿›åº¦å¤±è´¥:', error);
                        gameProgress = {
                            level1Completed: false,
                            currentLevel: 1,
                            unlockedLevels: [1]
                        };
                    }
                    
                    console.log(`ğŸ“Š å¤‡ç”¨å¤„ç† - æ¸¸æˆè¿›åº¦:`, gameProgress);
                    
                    const isUnlocked = gameProgress.unlockedLevels.includes(levelNum);
                    console.log(`ğŸ” å…³å¡ ${levelNum} è§£é”çŠ¶æ€: ${isUnlocked}`);
                    
                    if (isUnlocked) {
                        console.log(`âœ… è¿›å…¥å…³å¡ ${levelNum}`);
                        window.location.href = `game.html?level=${levelNum}`;
                    } else {
                        console.log(`ğŸ”’ å…³å¡ ${levelNum} æœªè§£é”`);
                        alert(`å…³å¡ ${levelNum} æœªè§£é”`);
                    }
                }
                
                // æ·»åŠ æ–°çš„è§¦æ‘¸äº‹ä»¶ç›‘å¬å™¨
                card.addEventListener('touchstart', function(e) {
                    console.log(`ğŸ“± å¤‡ç”¨è§¦æ‘¸å¼€å§‹ - å…³å¡ ${levelNum}`);
                    e.preventDefault();
                    e.stopPropagation();
                    this.style.transform = 'scale(0.95)';
                }, {passive: false});
                
                card.addEventListener('touchend', function(e) {
                    console.log(`ğŸ“± å¤‡ç”¨è§¦æ‘¸ç»“æŸ - å…³å¡ ${levelNum}`);
                    e.preventDefault();
                    e.stopPropagation();
                    this.style.transform = '';
                    
                    // ç«‹å³è§¦å‘
                    backupLevelClick();
                }, {passive: false});
                
                // ä¹Ÿæ·»åŠ ç‚¹å‡»äº‹ä»¶ä½œä¸ºå¤‡ç”¨
                card.addEventListener('click', function(e) {
                    console.log(`ğŸ–±ï¸ å¤‡ç”¨ç‚¹å‡» - å…³å¡ ${levelNum}`);
                    e.preventDefault();
                    e.stopPropagation();
                    backupLevelClick();
                });
                
                console.log(`âœ… å…³å¡ ${levelNum} å¤‡ç”¨äº‹ä»¶ç»‘å®šå®Œæˆ`);
            });
            
            console.log('ğŸ¯ ç§»åŠ¨ç«¯è§¦æ‘¸ä¿®å¤å®Œæˆï¼');
        }, 1000);  // å»¶è¿Ÿ1ç§’ç¡®ä¿æ‰€æœ‰åˆå§‹åŒ–å®Œæˆ
    </script>
</body>
</html>
